@page "/users/{id}"
@using TaskLauncher.Api.Contracts.Responses
@attribute [Authorize(Policy = "admin-policy")]

<SpinLoader IsLoading="@(loading)" Spinner="SpinnerType.Circle">
    <ContentTemplate>

        <div class="container">
            <div class="row">

                <ProfileComponent User=User ReadOnly="true" />

                @if (User.Blocked.HasValue && User.Blocked.Value)
                {
                    <button class="btn btn-success" style="width:130px; margin: 10px" @onclick="UnBanUserAsync">Unban user</button>
                }
                else
                {
                    <button class="btn btn-danger" style="width:130px; margin: 10px" @onclick="BanUserAsync">Ban user</button>
                }

                @if (User.Vip)
                {
                    <button class="btn btn-danger" style="width:130px; margin: 10px" @onclick="UnVipAsync">Take off vip</button>
                }
                else
                {
                    <button class="btn btn-success" style="width:130px; margin: 10px" @onclick="VipAsync">Give vip</button>
                }

                <div class="form-group" style="margin-top:10px; margin-bottom:10px">
                    <div class="input-group align-items-md-center">
                        <RadzenLabel Text="Add tokens" style="margin-right: 10px"/>
                        <RadzenNumeric TValue="int" Min="0" Max="1000" @bind-Value="@tokenBalance" style="max-width: 200px; margin-right: 10px" Class="w-100" />
                        <div style="margin-left: 2px; vertical-align:central; display:block">
                            <button class="btn btn-block btn-success" @onclick="UpdateBalance">
                                <span class="oi oi-plus" aria-hidden="true"></span>
                            </button>
                        </div>
                    </div>
                </div>

            </div>

            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <RadzenTabs TabPosition="TabPosition.Top" style="max-width: 1500px;" RenderMode="TabRenderMode.Client">
                            <Tabs>
                                <RadzenTabsItem Text="Bans">
                                    <GridComponent T="BanResponse" Grid="@banGrid"></GridComponent>
                                </RadzenTabsItem>
                                <RadzenTabsItem Text="Payments">
                                    <GridComponent T="PaymentResponse" Grid="@paymentGrid"></GridComponent>
                                </RadzenTabsItem>
                                <RadzenTabsItem Text="Tasks">
                                    <GridComponent T="TaskResponse" Grid="@taskGrid"></GridComponent>
                                </RadzenTabsItem>
                            </Tabs>
                        </RadzenTabs>
                    </div>
                </div>
            </div>
        </div>

    </ContentTemplate>
</SpinLoader>