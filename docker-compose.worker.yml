version: '3.5'

networks:
  localdev:
    name: localdev
    
services:
  tasklauncher.worker:
    image: tasklauncher.worker
    container_name: tasklauncher.worker
    build:
      context: .
      dockerfile: TaskLauncher.Worker/Dockerfile
    environment:
      - ServiceAddresses__WebApiAddress=https://tasklauncher.app.server:443
      - ServiceAddresses__HubAddress=https://tasklauncher.app.server:443/WorkerHub
      - TaskLauncherConfig__Source=bp_worker-vol
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - worker-vol:/app/tmp
    depends_on:
      - tasklauncher.app.server
    networks:
      - localdev

volumes:
  worker-vol: